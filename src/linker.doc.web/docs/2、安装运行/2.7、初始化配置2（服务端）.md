---
sidebar_position: 7
slug: /install/config-server
---

# 2.7、初始化配置2（服务端）

## 1、服务端手动修改配置文件

这是自建服务器需要配置的，没有服务器则跳过

:::tip[服务端运行流程]
1. 运行程序，在configs目录下会生成 common.json server.json
2. 关闭程序
3. 修改common.json，Modes 只保留 server
4. 修改server.json，可以去在线生成一些GUID作为各个功能的密钥
5. 再次运行程序

server.json
```
{
    "Cdkey": {
        // Cdkey 加解密密钥
        "SecretKey": "snltty"
    },
    //中继
    "Relay": {
        //多节点
        "Distributed": {
            //作为节点时配置
            "Node": {
                //节点Id
                "Id": "279DBACF-6F0B-46D4-9BA9-902EB6824849",
                //节点名称
                "Name": "default",
                //节点地址 域名/IP:端口 或 域名/IP，当只填写域名/IP时，默认使用 ServicePort
                "Host": "0.0.0.0:1802",
                //节点最大连接数
                "MaxConnection": 0,
                //节点连接最大带宽
                "MaxBandwidth": 0,
                //节点最大总带宽
                "MaxBandwidthTotal": 0,
                //节点最大流量
                "MaxGbTotal": 0,
                //节点剩余流量
                "MaxGbTotalLastBytes": 0,
                //当前月份，月份变化时重置剩余流量
                "MaxGbTotalMonth": 0,
                //节点是否公开
                "Public": false,
                //主机地址
                "MasterHost": "127.0.0.1:1802",
                //主机密钥
                "MasterSecretKey": "snltty",
                //随便url，管理页面展示时点击跳转
                "Url": "https://linker-doc.snltty.com",
                //支持TCP
                "AllowTcp": true,
                //支持UDP
                "AllowUdp": false,
                //与主机同步版本
                "Sync2Server": false,
                //主机备用地址，默认不填即可
                "MasterHosts": []
            },
            //作为主机时
            "Master": {
                "SecretKey": "snltty"
            }
        }
    },
    //服务端口
    "ServicePort": 1802,
    //API端口，公开一些信息
    "ApiPort": 1803,
    //主机列表，客户端、中继、内网穿透，这些功能都会读取，当主机不可用时按顺序尝试连接此列表内地址
    "Hosts": [],
    //内网穿透
    "SForward": {
        //http端口，用域名区分服务
        "WebPort": 12345,
        //tcp端口，用端口区分服务
        "TunnelPortRange": [
            10000,
            60000
        ],
        //多节点
        "Distributed": {
            "Node": {
                //节点Id
                "Id": "94EB2483-B546-43A9-AC90-135837EBEE3C",
                //节点名称
                "Name": "default",
                //节点域名，客户端填写域名时如果没有 . 就拼上此域名，比如客户端填写test，最后拼为test.aaa.com，如果客户端填写带 . 比如 test5.aaa.com，那就不拼，直接使用客户端填写的域名
                "Domain": "aaa.com",
                //节点web端口地址 域名/IP:端口 或 域名/IP，当只填写域名/IP时，默认使用 WebPort
                "Host": "",
                //最大连接带宽
                "MaxBandwidth": 0,
                //节点最大总带宽
                "MaxBandwidthTotal": 0,
                //节点最大流量
                "MaxGbTotal": 0,
                //节点剩余流量
                "MaxGbTotalLastBytes": 0,
                //当前月份，月份变化时重置剩余流量
                "MaxGbTotalMonth": 0,
                //节点是否公开
                "Public": false,
                //主机地址
                "MasterHost": "127.0.0.1:1802",
                //主机密钥
                "MasterSecretKey": "snltty",
                //随便url，管理页面展示时点击跳转
                "Url": "https://linker-doc.snltty.com",
                //与主机同步版本
                "Sync2Server": false,
                //主机备用地址，默认不填即可
                "MasterHosts": []
            },
            //作为主机时
            "Master": {
                "SecretKey": "snltty"
            }
        }
    },
    //登入
    "SignIn": {
        //清理超过7天不上线的客户端
        "CleanDays": 7,
        //启用登入，不启用时客户端无法连接
        "Enabled": true,
        //允许匿名登入，不允许匿名时需要填写正确的密钥+密码
        "Anonymous": true,
        //超级密钥，客户端填写正确后，拥有完全权限，可以对服务端做一些管理更改
        "SuperKey": "snltty",
        //超级密码
        "SuperPassword": "snltty"
    },
    //虚拟网卡
    "Tuntap": {
        //ip租约
        "Lease": {
            //ip租约时间
            "IPDays": 7,
            //网络租约时间
            "NetworkDays": 30
        }
    },
    //更新
    "Updater": {
        //要求客户端与服务端同步版本
        "Sync2Server": false
    }
}
```
action.json，这个可以不管，等用得上自定义验证的时候就知道了
```
{
    "SignInActionUrl": "", //登入信标的验证接口
    "RelayActionUrl": "", //中继验证接口
    "RelayNodeUrl": "", //中继节点验证接口
    "SForwardActionUrl": ""//服务器穿透的验证接口
}
```
:::
