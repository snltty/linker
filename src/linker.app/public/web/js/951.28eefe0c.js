"use strict";(self["webpackChunklinker_web"]=self["webpackChunklinker_web"]||[]).push([[951],{1951:function(e,l,a){a.r(l),a.d(l,{default:function(){return $}});var t=a(6768),o=a(4232);const n=e=>((0,t.Qi)("data-v-01637812"),e=e(),(0,t.jt)(),e),r={class:"logger-setting-wrap flex flex-column h-100",ref:"wrap"},g={class:"inner h-100 flex flex-column flex-nowrap"},s={class:"head flex"},i=n((()=>(0,t.Lk)("span",{class:"flex-1"},null,-1))),u={class:"body flex-1 relative"},d={class:"absolute"},c={class:"pages t-c"},b={class:"page-wrap"},p={class:"logger-content"};function f(e,l,a,n,f,m){const k=(0,t.g2)("el-option"),h=(0,t.g2)("el-select"),v=(0,t.g2)("el-button"),w=(0,t.g2)("el-table-column"),F=(0,t.g2)("el-table"),_=(0,t.g2)("el-pagination"),y=(0,t.g2)("el-tab-pane"),C=(0,t.g2)("AccessShow"),L=(0,t.g2)("Setting"),z=(0,t.g2)("el-tabs"),S=(0,t.g2)("el-dialog");return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.Lk)("div",r,[(0,t.bF)(z,{type:"border-card",class:"h-100 w-100"},{default:(0,t.k6)((()=>[(0,t.bF)(C,{value:"LoggerShow"},{default:(0,t.k6)((()=>[(0,t.bF)(y,{label:e.$t("logger.list"),class:"h-100"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",g,[(0,t.Lk)("div",s,[(0,t.Lk)("div",null,[(0,t.bF)(h,{modelValue:n.state.type,"onUpdate:modelValue":l[0]||(l[0]=e=>n.state.type=e),onChange:n.loadData,size:"small",class:"mgr-1",style:{width:"6rem"}},{default:(0,t.k6)((()=>[(0,t.bF)(k,{value:-1,label:"all"}),(0,t.bF)(k,{value:0,label:"debug"}),(0,t.bF)(k,{value:1,label:"info"}),(0,t.bF)(k,{value:2,label:"warning"}),(0,t.bF)(k,{value:3,label:"error"}),(0,t.bF)(k,{value:4,label:"fatal"})])),_:1},8,["modelValue","onChange"])]),(0,t.bF)(v,{type:"warning",size:"small",loading:n.state.loading,onClick:n.clearData},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.$t("logger.clear")),1)])),_:1},8,["loading","onClick"]),(0,t.bF)(v,{size:"small",loading:n.state.loading,onClick:n.loadData},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.$t("logger.refresh")),1)])),_:1},8,["loading","onClick"]),i]),(0,t.Lk)("div",u,[(0,t.Lk)("div",d,[(0,t.bF)(F,{stripe:"",border:"",data:n.state.page.List,size:"small",width:"100%",height:"100%",onRowClick:n.handleRowClick,"row-class-name":n.tableRowClassName},{default:(0,t.k6)((()=>[(0,t.bF)(w,{type:"index",width:"50"}),(0,t.bF)(w,{prop:"Type",label:e.$t("logger.level"),width:"80"},{default:(0,t.k6)((e=>[(0,t.Lk)("span",null,(0,o.v_)(n.state.types[e.row.Type]),1)])),_:1},8,["label"]),(0,t.bF)(w,{prop:"Time",label:e.$t("logger.time"),width:"160"},null,8,["label"]),(0,t.bF)(w,{prop:"content",label:e.$t("logger.content")},null,8,["label"])])),_:1},8,["data","onRowClick","row-class-name"])])]),(0,t.Lk)("div",c,[(0,t.Lk)("div",b,[(0,t.bF)(_,{small:"",total:n.state.page.Count,currentPage:n.state.page.Page,"onUpdate:currentPage":l[1]||(l[1]=e=>n.state.page.Page=e),"page-size":n.state.page.Size,"pager-count":n.globalData.isPc?7:3,layout:n.globalData.isPc?"total,prev, pager, next":"prev, pager, next",onCurrentChange:n.handlePageChange,background:""},null,8,["total","currentPage","page-size","pager-count","layout","onCurrentChange"])])])])])),_:1},8,["label"])])),_:1}),(0,t.bF)(C,{value:"LoggerLevel"},{default:(0,t.k6)((()=>[(0,t.bF)(y,{label:e.$t("common.setting")},{default:(0,t.k6)((()=>[(0,t.bF)(L)])),_:1},8,["label"])])),_:1})])),_:1})],512),(0,t.bF)(S,{class:"options-center",title:"","destroy-on-close":"",modelValue:n.state.show,"onUpdate:modelValue":l[2]||(l[2]=e=>n.state.show=e),width:"98%",top:"2vh"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",null,[(0,t.Lk)("textarea",p,(0,o.v_)(n.state.content),1)])])),_:1},8,["modelValue"])],64)}var m=a(144),k=a(4);const h=e=>(0,k.zG)("logger/get",e),v=()=>(0,k.zG)("logger/clear"),w=()=>(0,k.zG)("logger/getconfig"),F=e=>(0,k.zG)("logger/setconfig",e),_={class:"t-c w-100"};function y(e,l,a,n,r,g){const s=(0,t.g2)("el-input"),i=(0,t.g2)("el-form-item"),u=(0,t.g2)("el-col"),d=(0,t.g2)("el-option"),c=(0,t.g2)("el-select"),b=(0,t.g2)("el-row"),p=(0,t.g2)("el-button"),f=(0,t.g2)("el-form"),m=(0,t.gN)("trim");return(0,t.uX)(),(0,t.Wv)(f,{"label-width":"8rem",ref:"formDom",model:n.state.form,rules:n.state.rules},{default:(0,t.k6)((()=>[(0,t.bF)(i,{label:"","label-width":"0"},{default:(0,t.k6)((()=>[(0,t.bF)(b,null,{default:(0,t.k6)((()=>[(0,t.bF)(u,{xs:24,sm:8,md:8,lg:8,xl:8},{default:(0,t.k6)((()=>[(0,t.bF)(i,{label:e.$t("logger.count"),prop:"Size"},{default:(0,t.k6)((()=>[(0,t.bo)((0,t.bF)(s,{size:"default",modelValue:n.state.form.Size,"onUpdate:modelValue":l[0]||(l[0]=e=>n.state.form.Size=e)},null,8,["modelValue"]),[[m]])])),_:1},8,["label"])])),_:1}),(0,t.bF)(u,{xs:24,sm:8,md:8,lg:8,xl:8},{default:(0,t.k6)((()=>[(0,t.bF)(i,{label:e.$t("logger.level"),prop:"LoggerType"},{default:(0,t.k6)((()=>[(0,t.bF)(c,{modelValue:n.state.form.LoggerType,"onUpdate:modelValue":l[1]||(l[1]=e=>n.state.form.LoggerType=e)},{default:(0,t.k6)((()=>[(0,t.bF)(d,{value:0,label:"debug"}),(0,t.bF)(d,{value:1,label:"info"}),(0,t.bF)(d,{value:2,label:"warning"}),(0,t.bF)(d,{value:3,label:"error"}),(0,t.bF)(d,{value:4,label:"fatal"})])),_:1},8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1})])),_:1}),(0,t.bF)(i,{"label-width":"0"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",_,[(0,t.bF)(p,{type:"primary",loading:n.state.loading,onClick:n.submit},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.$t("common.confirm")),1)])),_:1},8,["loading","onClick"])])])),_:1})])),_:1},8,["model","rules"])}var C=a(1219),L={setup(){const e=(0,m.KR)(null),l=(0,m.Kh)({loading:!1,configInfo:{},form:{Size:0,LoggerType:-1},rules:{Size:[{required:!0,message:"必填",trigger:"blur"},{type:"number",min:1,max:1e4,message:"数字 1-10000",trigger:"blur",transform(e){return Number(e)}}]}}),a=()=>{w().then((e=>{l.configInfo=e,l.form.Size=e.Size,l.form.LoggerType=e.LoggerType})).catch((e=>{}))},o=()=>{let e=JSON.parse(JSON.stringify(l.configInfo));return e.Size=+l.form.Size,e.LoggerType=+l.form.LoggerType,e},n=()=>new Promise(((a,t)=>{e.value.validate((e=>{if(0==e)return t(),!1;l.loading=!0;const n=o();F(n).then((e=>{l.loading=!1,a(),e?C.nk.success("操作成功!"):C.nk.error("操作失败!")})).catch((e=>{console.log(e),l.loading=!1,a()}))}))}));return(0,t.sV)((()=>{a()})),{state:l,formDom:e,submit:n}}},z=a(1241);const S=(0,z.A)(L,[["render",y],["__scopeId","data-v-9857fa74"]]);var x=S,P=a(3830),V={components:{Setting:x},setup(){const e=(0,P.B)(),l=(0,m.KR)(null),a=(0,m.Kh)({loading:!0,type:-1,page:{Page:1,Size:20,Count:0,List:[]},types:["debug","info","warning","error","fatal"],show:!1,content:""}),o=()=>{a.loading=!0,h({Page:a.page.Page,Size:a.page.Size,Type:a.type}).then((e=>{a.loading=!1,e.List.map((e=>{e.content=e.Content.substring(0,50)})),a.page=e})).catch((e=>{console.log(e),a.loading=!1}))},n=e=>{e&&(a.page.Page=e,o())},r=()=>{a.loading=!0,v().then((()=>{a.loading=!1,o()})).catch((()=>{a.loading=!1}))},g=({row:e,rowIndex:l})=>`type-${e.Type}`,s=(e,l,t)=>{a.show=!0,a.content=e.Content};return(0,t.sV)((()=>{o()})),{globalData:e,wrap:l,state:a,loadData:o,clearData:r,tableRowClassName:g,handleRowClick:s,handlePageChange:n}}};const T=(0,z.A)(V,[["render",f],["__scopeId","data-v-01637812"]]);var $=T}}]);